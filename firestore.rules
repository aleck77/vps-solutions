rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // ===== Subscribers =====
    // Любой пользователь может создать запись (подписаться).
    // Никто (через клиентский SDK) не может читать, изменять или удалять список подписчиков.
    match /subscribers/{subscriberId} {
      allow read, update, delete: if false;
      allow create: if true;
    }

    // ===== Blog Posts =====
    // Любой пользователь может читать опубликованные посты.
    // Только администраторы могут создавать, обновлять или удалять посты.
    match /posts/{postId} {
      allow read: if resource.data.published == true;
      allow write: if request.auth.token.admin == true;
    }

    // ===== Categories =====
    // Любой пользователь может читать список категорий.
    // Только администраторы могут изменять категории.
    match /categories/{categoryId} {
      allow read: if true;
      allow write: if request.auth.token.admin == true;
    }
    
    // ===== Pages =====
    // Любой пользователь может читать страницы.
    // Только администраторы могут создавать или изменять страницы.
    match /pages/{pageId} {
        allow read: if true;
        allow write: if request.auth.token.admin == true;
    }

    // ===== Navigation =====
    // Любой пользователь может читать меню навигации.
    // Только администраторы могут изменять меню.
    match /navigation/{navId} {
        allow read: if true;
        allow write: if request.auth.token.admin == true;
    }
  }
}
